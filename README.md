# PencilNet
This repo will host dataset, models, and implementation code of PencilNet.

## Abstract

In autonomous and mobile robotics, one of the main challenges is the robust on-the-fly perception of the environment which is often unknown and dynamic, like in autonomous drone racing. In this work, we propose a novel deep neural network-based perception method for racing gate detection -- PencilNet -- which relies on a lightweight neural network backbone on top of a pencil filter. This approach unifies predictions of the gates' 2D position, distance and orientation in a single pose tuple. We show that our method is effective for zero-shot sim-to-real transfer learning that does not need any real-time training samples. Moreover, compared to state-of-art methods, our framework is extremely robust to illumination changes commonly seen under rapid flight. A thorough set of experiments demonstrates the effectiveness of this approach in multiple challenging scenarios, where the drone completes various tracks under different lighting conditions.

## Dataset

The simulation dataset generated by Unreal Engine 4 from various environments together with our drone racing gate design. The print-ready gate pattern and its 3D mesh model will be also made available for interested researchers.

- Training dataset: 31k RGB fisheye-distorted images, annotation file (*.json) and training & testing indices (0.9 and 0.1 respectively in *.npy) can be downloaded here: [RGB training dataset](https://drive.google.com/file/d/1HiRcgx7fSzGJhBtc5sE8JzztagGqBvOE/view?usp=sharing). Respective pencil images of the same dataset can be downloaded here: [Pencil training dataset](https://drive.google.com/file/d/1P6oF6HkBcgiz7UoKXevHI0ZIs83Eyuvo/view?usp=sharing)

- Testing dataset: multiple images from different simulation environments (that do not appear in training dataset) and real world scenarios can be downloaded here: [RGB test dataset](https://drive.google.com/file/d/1Q_zz7A_zGIDsKvCsjJ_o9W4IbJymHc2P/view?usp=sharing). Again, the respective pencil images of the test dataset can be obtained here: [Pencil test dataset](https://drive.google.com/file/d/1N9ckkTGaXhV6MIfxEH7OBo_lffOX4GQM/view?usp=sharing)

## Training and Evaluation

To be updated
## ROS detection node

Included. To be explained

